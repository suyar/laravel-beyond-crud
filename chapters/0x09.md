# 进入应用层（Entering the application layer）

在第一章我就曾经写道，面向领域的 Laravel 项目的特点之一是：

> [...] 非常重要的是，你开始考虑以业务概念进行分组，而不是以具有相同技术属性的代码进行分组。

换句话说：根据它在现实世界中的相似性来分组，而不是根据它在代码库中的用途进行分组。

我还说过，领域和应用程序代码是两个独立的东西。此外，如果应用程序需要向外提供该领域的功能，还需要能同时使用几个领域。

但是，这个应用层究竟是干什么的呢？我们如何对它的代码进行分组？这些问题将在本章中得到解答。

马上进入应用层。

## 一些应用程序（Several applications）

首先要明白的重点是，一个项目可以有几个应用程序。事实上, 每个 Laravel 项目都已经有两个默认的应用程序: `HTTP` 和 `console` 应用程序。不仅如此，一个项目还有其他几个部分可以被认为是独立的应用程序: 每一个第三方集成（third-party integration）、`REST API`、用户端、管理后台等。

所有这些都可以被认为是独立的应用程序，为它们自己特定的场景暴露（exposing）和展示（presenting）领域。事实上，我认为 `artisan` 控制台只是这些应用程序中的其中一个：它是开发人员用来处理和操作项目的一个应用程序。

不过，由于我们是从事 Web 开发的，我们的主要重点可能是与 `HTTP` 有关的应用程序。那么，其中包括哪些内容呢？让我们来看看：

- 控制器（Controllers）
- 请求（Requests）
- 特定请求的验证规则（Request-specific validation rules）
- 中间件（Middleware）
- 资源（Resources）
- 视图模型（ViewModels）
- HTTP 查询构造器 (用于解析 HTTP 请求参数)

我甚至认为 Blade 视图、JavaScript 和 CSS 文件属于一个应用程序，而不应该被放在资源文件夹中。我意识到这对许多人来说是太遥远了，但我想至少要提一下。

一般来说，一个应用程序的目的是获得某种输入，将其做一些转换以供领域层调用，并将输出展示给用户或存储在某个地方。到现在为止，大多数应用程序代码仅仅是结构化的，甚至通常是无聊的代码，仅仅是将数据从一个地方传递到另一个地方，这并不奇怪。毕竟：所有复杂的逻辑都由我们的领域代码处理。

不过，关于上面提到的几个概念还有很多东西要讲，所以我们将在接下来的章节中探讨应用层（application layer）。但首先让我们关注一下应用层的一般架构（architecture）。

## 构建 HTTP 应用程序（Structuring HTTP applications）

在继续下一步之前, 我们需要讨论一个非常重要的问题: 一个 HTTP 应用程序通常会如何构建？我们是应该遵循 Laravel 的惯例，还是需要再考虑一下？

既然我用了一章的时间来讨论这个问题，你可能已经猜到了答案。所以让我们看看 Laravel 建议你在一个典型的 HTTP 应用默认怎么做：

```
App/Admin
├── Http
│   ├── Controllers
│   ├── Kernel.php
│   └── Middleware
├── Requests
├── Resources
├── Rules
└── ViewModels
```

这种结构在小项目中是没毛病的，但说实话，格局小了。为了明确我的意思，我将向你展示我们一个客户项目中的 `admin` 应用程序的结构。显然，我不能透露这个项目的太多信息，所以我把大部分的类名都打码了。注意：由于我们在这个系列中一直使用发票作为例子，所以我在 `admin` 应用程序中强调了一些与发票有关的类。往下看，享受翻页的乐趣吧！

---

<details>
<summary>点击展开代码</summary>
<pre><code>
App/Admin
├── Controllers
│   ├── █████████
│   │   ├── ███████████████████.php
│   │   ├── ████████████████████████████████.php
│   │   ├── ███████████████████████.php
│   │   ├── ██████████████████████████████████.php
│   │   ├── ███████████████████████.php
│   │   ├── █████████████████████████.php
│   │   ├── ███████████████████████.php
│   │   ├── ███████████████████████████████.php
│   │   ├── ██████████████████.php
│   │   └── ████████████████.php
│   ├── ████████████
│   │   ├── ████████████████████████████████.php
│   │   ├── ████████████████
│   │   │   ├── ████████████████████████████████.php
│   │   │   ├── █████████████████████████████████████████.php
│   │   │   ├── ██████████████████████████████.php
│   │   │   ├── ████████████████████████████████.php
│   │   │   ├── ███████████████████████████████.php
│   │   │   └── ████████████████████████████████.php
│   │   ├── █████████████████████████████████.php
│   │   ├── ██████████████████████████████████.php
│   │   ├── █████████████████████████████████.php
│   │   ├── ██████████████████████████████.php
│   │   ├── █████████████████████████████.php
│   │   ├── █████████████████████████████████████████.php
│   │   ├── █████████████████████████████████████.php
│   │   ├── ██████████████████████████████████.php
│   │   ├── █████████████████████████████████████████.php
│   │   ├── ████████████████████████████████████.php
│   │   ├── █████████████
│   │   │   ├── █████████████████████████████.php
│   │   │   ├── ███████████████████████████.php
│   │   │   ├── █████████████████████████████.php
│   │   │   ├── ███████████████████████████████████████████.php
│   │   │   ├── ███████████████████████████████████████.php
│   │   │   ├── ████████████████████████████.php
│   │   │   └── █████████████████████████████.php
│   │   ├── ██████████████████████████████.php
│   │   └── █████████████████████████.php
│   ├── ███
│   │   ├── ████████████████████.php
│   │   ├── ██████████████████████.php
│   │   ├── █████████████████████.php
│   │   ├── █████████████.php
│   │   ├── █████████████████████.php
│   │   ├── ██████████████████.php
│   │   ├── ██████████████████.php
│   │   ├── ██████████████████████.php
│   │   ├── ██████████████████████.php
│   │   ├── ███████████████████.php
│   │   ├── ████████████████████.php
│   │   ├── ██████████████████.php
│   │   ├── ██████████████████████████.php
│   │   ├── ████████████████████.php
│   │   ├── ██████████████████.php
│   │   └── ████████████████.php
│   ├── ███████████████████.php
│   ├── █████████████████████.php
│   ├── ████████████
│   │   ├── ███████████████████████.php
│   │   ├── ██████████████████.php
│   │   ├── ████████████████████.php
│   │   ├── ████████████████████.php
│   │   ├── ████████████████████████
│   │   │   ├── █████████████████████████████████████████.php
│   │   │   ├── ██████████████████████████████████████.php
│   │   │   ├── █████████████████████████████████.php
│   │   │   ├── ██████████████████████████████.php
│   │   │   ├── ███████████████████████████████.php
│   │   │   ├── ███████████████████████████████████████.php
│   │   │   ├── ███████████████████████████████.php
│   │   │   ├── ████████████████████████████████████████.php
│   │   │   └── █████████████████████████████████████.php
│   │   ├── Invoices
│   │   │   ├── ████████████████████████████████████.php
│   │   │   ├── █████████████████████.php
│   │   │   ├── IgnoreMissedInvoicesController.php
│   │   │   ├── ██████████████████████.php
│   │   │   ├── ████████████████████.php
│   │   │   ├── InvoiceStatusController.php
│   │   │   ├── InvoicesController.php
│   │   │   ├── MissedInvoicesController.php
│   │   │   ├── ████████████████████████.php
│   │   │   └── RefreshMissedInvoicesController.php
│   │   ├── ████████
│   │   │   └── █████████████████████.php
│   │   ├── ██████████████████.php
│   │   └── ██████████████████.php
│   ├── ███████████████████
│   │   ├── ████████████████████████.php
│   │   ├── ████████████████████████████.php
│   │   ├── ███████████████████.php
│   │   ├── ████████████████████.php
│   │   ├── ████████████████████.php
│   │   ├── ██████████████████████████.php
│   │   ├── ███████████████████████████.php
│   │   ├── ██████████████████████████████████.php
│   │   ├── ███████████████████████████████████.php
│   │   ├── ██████████████████████████.php
│   │   ├── ███████████████████████████████.php
│   │   ├── ████████████████████████████████.php
│   │   ├── ████████████████████████.php
│   │   ├── ████████████████████████.php
│   │   ├── █████████████████████.php
│   │   ├── ██████████████████████████.php
│   │   ├── ██████████████████████████████.php
│   │   ├── ██████████████████████████.php
│   │   ├── ███████████████████████.php
│   │   ├── ██████████████████████.php
│   │   ├── ████████████████████████████.php
│   │   ├── ███████████████████████.php
│   │   ├── █████████████████████████████.php
│   │   ├── ██████████████████████.php
│   │   ├── ███████████████████████████████.php
│   │   ├── ███████████████████████.php
│   │   ├── ███████████████████████.php
│   │   ├── ███████████████████████████████.php
│   │   ├── ████████████████████████.php
│   │   ├── ██████████████████████████████.php
│   │   ├── ███████████████████████████████.php
│   │   ├── █████████████████████████.php
│   │   ├── ██████████████████████.php
│   │   ├── ███████████████████████████.php
│   │   ├── █████████████████████████████████.php
│   │   ├── ███████████████████████████.php
│   │   ├── ████████████████████████████.php
│   │   ├── ████████████████████.php
│   │   └── ███████████████.php
│   ├── ███████████████.php
│   ├── ███████████████.php
│   ├── █████████████
│   │   ├── █████████████████████.php
│   │   ├── █████████████████████████████.php
│   │   ├── ████████████████████████████.php
│   │   ├── ███████████████████████████.php
│   │   ├── ██████████████████████████.php
│   │   ├── ██████████████████████████.php
│   │   └── █████████████████████████.php
│   ├── ██████████████████.php
│   ├── █████████████████.php
│   ├── █████████████████████████.php
│   ├── ██████████████████████.php
│   ├── ████████
│   │   ├── ███████████████████.php
│   │   ├── ███████████████████████████.php
│   │   ├── █████████████████████.php
│   │   └── █████████████████.php
│   ├── ███████████████
│   │   ├── █████████████████.php
│   │   ├── ███████████████.php
│   │   ├── ██████████████.php
│   │   ├── ████████████████████████.php
│   │   ├── ██████████████████████████.php
│   │   ├── ██████████████████████████.php
│   │   └── ███████████████████.php
│   ├── ████████████████████.php
│   ├── ██████████
│   │   ├── ███████████████████████████.php
│   │   ├── ██████████████████.php
│   │   ├── ███████████████████.php
│   │   ├── ███████████████.php
│   │   ├── ████████████████████████.php
│   │   ├── █████████████████████████████.php
│   │   ├── ████████████████████████.php
│   │   ├── █████████████████████.php
│   │   ├── ████████████████████.php
│   │   ├── ████████████████████████.php
│   │   ├── ████████████████████████████.php
│   │   ├── ███████████████████████.php
│   │   ├── ███████████████████.php
│   │   ├── ███████████████████████.php
│   │   ├── ████████████████.php
│   │   ├── ██████████████████.php
│   │   ├── █████████████████.php
│   │   ├── ██████████████████.php
│   │   ├── █████████████████████████████.php
│   │   ├── ██████████████████████.php
│   │   ├── ████████████████████.php
│   │   ├── ████████████████████████.php
│   │   ├── ███████████████████.php
│   │   ├── ███████████████.php
│   │   └── ██████████████████.php
│   ├── ███████
│   │   └── ████████████████.php
│   └── ███████████████.php
├── Filters
│   ├── ████████████████████.php
│   ├── ███████████████████████████.php
│   ├── █████████████████████████.php
│   ├── ██████████████████████████████████.php
│   ├── ██████████████████████.php
│   ├── █████████████████████████████.php
│   ├── ██████████████████████████.php
│   ├── ████████████████.php
│   ├── ███████████.php
│   ├── ███████████.php
│   ├── ████████████████.php
│   ├── InvoiceMonthFilter.php
│   ├── InvoiceOfferFilter.php
│   ├── InvoiceStatusFilter.php
│   ├── InvoiceYearFilter.php
│   ├── █████████████████████.php
│   ├── ███████████.php
│   └── ███████████████████.php
├── Middleware
│   ├── ██████████████████████████.php
│   ├── █████████████████████.php
│   ├── █████████████████████████████████.php
│   ├── █████████████████████████████████████.php
│   ├── EnsureValidHabitantInvoiceCollectionSettingsMiddleware.php
│   ├── EnsureValidInvoiceDraftSettingsMiddleware.php
│   ├── ██████████████████████████████████.php
│   ├── EnsureValidOwnerInvoiceCollectionSettingsMiddleware.php
│   ├── ██████████████████████.php
│   ├── █████████████████████.php
│   ├── █████████████████████████████.php
│   ├── █████████████████████████████████.php
│   ├── ████████████████████.php
│   ├── ███████████████████.php
│   └── █████████████████.php
├── Queries
│   ├── ██████████████████.php
│   ├── ███████████████████████████.php
│   ├── ██████████████████.php
│   ├── ████████████████████████.php
│   ├── ██████████████████████.php
│   ├── ██████████████████.php
│   ├── ██████████████████████.php
│   ├── ███████████████████.php
│   ├── ████████████████████████.php
│   ├── █████████████████████████████.php
│   ├── ████████████████████████.php
│   ├── ████████████████████.php
│   ├── █████████████████████.php
│   ├── ███████████████████.php
│   ├── ████████████████████.php
│   ├── █████████████████████████.php
│   ├── ██████████████████████.php
│   ├── ███████████████████████.php
│   ├── ██████████████████.php
│   ├── ██████████████████████████████████.php
│   ├── ███████████████████████████.php
│   ├── █████████████████████.php
│   ├── InvoiceCollectionIndexQuery.php
│   ├── InvoiceIndexQuery.php
│   ├── █████████████████████████████.php
│   ├── ███████████████████████.php
│   ├── ███████████████.php
│   ├── ████████████████████████████.php
│   ├── ████████████████████████.php
│   ├── ██████████████████.php
│   ├── █████████████████████.php
│   ├── █████████████████████████████.php
│   ├── ████████████████████.php
│   ├── ████████████████.php
│   ├── ██████████████████.php
│   ├── █████████████████████████.php
│   ├── ████████████████████████.php
│   ├── █████████████████████.php
│   ├── ██████████████████.php
│   ├── ███████████████████.php
│   ├── ███████████████.php
│   └── ███████████████.php
├── Requests
│   ├── █████████████████████████.php
│   ├── █████████████████████.php
│   ├── ██████████████.php
│   ├── ██████████████.php
│   ├── ██████████████.php
│   ├── ████████████████.php
│   ├── ██████████████████████████████.php
│   ├── ███████████████████████.php
│   ├── ███████████████████████████████.php
│   ├── █████████████████████████████.php
│   ├── InvoiceRequest.php
│   ├── ██████████████████████.php
│   ├── ███████████████████.php
│   ├── █████████████████████.php
│   ├── ████████████.php
│   ├── ████████████████████.php
│   ├── ████████████████████████████████████.php
│   ├── ██████████████████████████████████.php
│   ├── ██████████████████.php
│   ├── ███████.php
│   ├── ██████████████████████.php
│   ├── ████████████.php
│   ├── ███████████.php
│   └── ████████████████████████.php
├── Resources
│   ├── ████████████████.php
│   ├── ███████████████.php
│   ├── ██████████████.php
│   ├── ███████████████████████.php
│   ├── █████████████████████████████.php
│   ├── ███████████████████████████.php
│   ├── ███████████████████.php
│   ├── ███████████████.php
│   ├── ████████████████████████████.php
│   ├── ██████████████████████.php
│   ├── ████████████████████████████████████.php
│   ├── ████████████████████.php
│   ├── █████████████████████████████████.php
│   ├── ███████████████.php
│   ├── █████████████████████████████.php
│   ├── ████████████████████.php
│   ├── ████████████████████.php
│   ├── █████████████████████████████████████.php
│   ├── ████████████████████████.php
│   ├── ████████████████.php
│   ├── ████████████████████.php
│   ├── █████████████████████████████████████.php
│   ├── ███████████████████████████████.php
│   ├── ███████████████████████████.php
│   ├── ████████████████████.php
│   ├── █████████████████████.php
│   ├── █████████████████████████.php
│   ├── █████████████████████.php
│   ├── █████████████████.php
│   ├── █████████████████████.php
│   ├── ██████████████████.php
│   ├── █████████████████████████.php
│   ├── █████████████████.php
│   ├── ████████████████.php
│   ├── ████████████████████.php
│   ├── ███████████████████████████████.php
│   ├── ████████████████████████████████.php
│   ├── ████████████████████████████████.php
│   ├── █████████████████████████████.php
│   ├── ███████████████████████████████.php
│   ├── ████████████████████████.php
│   ├── ████████████████████████████.php
│   ├── ████████████████.php
│   ├── █████████████████████.php
│   ├── ███████████████████████.php
│   ├── █████████████████.php
│   ├── Invoices
│   │   ├── InvoiceCollectionDataResource.php
│   │   ├── InvoiceCollectionResource.php
│   │   ├── InvoiceDataResource.php
│   │   ├── InvoiceDraftResource.php
│   │   ├── InvoiceLineDataResource.php
│   │   ├── InvoiceLineResource.php
│   │   ├── InvoiceResource.php
│   │   ├── ██████████████████.php
│   │   ├── █████████████████.php
│   │   └── █████████████.php
│   ├── InvoiceIndexResource.php
│   ├── InvoiceLabelResource.php
│   ├── InvoiceMainOverviewResource.php
│   ├── InvoiceeResource.php
│   ├── ████████████████████.php
│   ├── █████████████.php
│   ├── ███████████████.php
│   ├── ██████████████████████████.php
│   ├── ████████████████████.php
│   ├── ██████████████████.php
│   ├── ██████████████.php
│   ├── █████████████████████████████.php
│   ├── ██████████████████████████.php
│   ├── █████████████████████.php
│   ├── █████████████████████████.php
│   ├── █████████████.php
│   ├── ██████████████████████.php
│   ├── ███████████████████.php
│   ├── ███████████████.php
│   ├── ███████████████.php
│   ├── ███████████████.php
│   ├── █████████████████████.php
│   ├── █████████████.php
│   ├── █████████████████.php
│   ├── ███████████████████.php
│   ├── ███████████████████████.php
│   ├── ██████████████.php
│   ├── ██████████████████████████.php
│   ├── █████████████████.php
│   ├── ██████████████████████.php
│   ├── █████████████.php
│   ├── █████████████████.php
│   ├── ████████████.php
│   ├── ███████████████████████.php
│   ├── ████████████████.php
│   ├── ████████████████████.php
│   ├── ████████████████████████████.php
│   ├── █████████████████████.php
│   ├── ██████████████████████████.php
│   ├── █████████████████.php
│   ├── █████████████████████.php
│   ├── ███████████████████.php
│   ├── ████████████.php
│   ├── ████████████████.php
│   ├── ████████████.php
│   └── █████████████████████.php
└── ViewModels
    ├── █████████████████.php
    ├── ███████████████.php
    ├── ████████████████████████.php
    ├── █████████████████.php
    ├── ████████████████████.php
    ├── █████████████████████████████████.php
    ├── ████████████████████████████.php
    ├── ██████████████████████████.php
    ├── ██████████████████████████████.php
    ├── ████████████████████████.php
    ├── █████████████████.php
    ├── ██████████████████████████████.php
    ├── █████████████████████████.php
    ├── █████████████████████.php
    ├── █████████████.php
    ├── ████████████████.php
    ├── ██████████████████.php
    ├── █████████████████████.php
    ├── ██████████████████████.php
    ├── ██████████████████████████.php
    ├── ██████████████████████.php
    ├── ██████████████████.php
    ├── ████████████████████.php
    ├── ███████████████████.php
    ├── ██████████████████.php
    ├── █████████████████████████████.php
    ├── ██████████████████████████.php
    ├── █████████████████████.php
    ├── █████████████████.php
    ├── ██████████████████████████.php
    ├── ███████████████.php
    ├── ███████████████████████████.php
    ├── ████████████████████████
    │   ├── ████████████████.php
    │   ├── █████████████████.php
    │   ├── ██████████████████.php
    │   └── ███████████████████████.php
    ├── █████████████████████████.php
    ├── ███████████████████████████████.php
    ├── ███████████████████████████████.php
    ├── ███████████████████████.php
    ├── ██████████████████.php
    ├── InvoiceCollectionHabitantContractPreviewViewModel.php
    ├── InvoiceCollectionOwnerContractPreviewViewModel.php
    ├── InvoiceCollectionPreviewViewModel.php
    ├── InvoiceDraftViewModel.php
    ├── InvoiceIndexViewModel.php
    ├── InvoiceLabelsViewModel.php
    ├── InvoiceStatusViewModel.php
    ├── █████████████████.php
    ├── █████████████████████.php
    ├── ██████████████████████.php
    ├── █████████████.php
    ├── ██████████████████.php
    ├── ███████████████████.php
    ├── ██████████████.php
    ├── ██████████████████████.php
    ├── ████████████████████████████.php
    ├── ██████████████████████████████████████.php
    ├── ████████████████.php
    ├── █████████████████.php
    ├── ████████████████████████.php
    ├── ████████████████████████.php
    ├── █████████████████████.php
    ├── ██████████████████.php
    ├── ████████████████████.php
    ├── ██████████████████████████████.php
    ├── █████████████████████████.php
    ├── ███████████████████████████████.php
    ├── ██████████████████.php
    ├── ███████████████.php
    ├── ██████████████.php
    ├── ████████████████████.php
    ├── ████████████████████████.php
    ├── █████████████████.php
    ├── █████████████████████████.php
    ├── ██████████████████.php
    ├── ████████████████████████████.php
    ├── █████████████████████████████.php
    ├── █████████████████████.php
    ├── ██████████████████████.php
    ├── ██████████████████.php
    ├── ██████████████████████.php
    ├── █████████████████████████.php
    ├── ██████████████████████.php
    ├── █████████████████.php
    ├── █████████████.php
    ├── █████████████.php
    ├── ██████████████████████.php
    ├── █████████.php
    └── █████████████████.php
</code></pre>
</details>

---

嗨~又见面了！

太长了，对吗？我没有开玩笑 —— 这是我们其中一个项目在开发了一年半之后的实际情况。请记住，这只是 `admin` 应用程序的代码，它不包含任何与领域相关的东西。

那么，这里的核心问题是什么呢？我们根据技术属性来分组，而不是根据现实世界的意义来分组；控制器和控制器放在一起，请求和请求放在一起，视图模型和视图模型放在一起等等。

像发票这样的概念再次被分散在多个目录中，并与其他几十个类混合在一起。即使有最好的 IDE 支持，也很难在你的脑子里作为一个整体来考虑，也没有办法对正在发生的事情有一个总体的了解。

解决办法 —— 我希望你不会感到惊讶 —— 与我们在领域所做的一样：将属于同一类别的代码分组。比如这个发票的例子：

```
Admin
└── Invoices
    ├── Controllers
    │   ├── IgnoreMissedInvoicesController.php
    │   ├── InvoiceStatusController.php
    │   ├── InvoicesController.php
    │   ├── MissedInvoicesController.php
    │   └── RefreshMissedInvoicesController.php
    ├── Filters
    │   ├── InvoiceMonthFilter.php
    │   ├── InvoiceOfferFilter.php
    │   ├── InvoiceStatusFilter.php
    │   └── InvoiceYearFilter.php
    ├── Middleware
    │   ├── EnsureValidHabitantInvoiceCollectionSettingsMiddleware.php
    │   ├── EnsureValidInvoiceDraftSettingsMiddleware.php
    │   └── EnsureValidOwnerInvoiceCollectionSettingsMiddleware.php
    ├── Queries
    │   ├── InvoiceCollectionIndexQuery.php
    │   └── InvoiceIndexQuery.php
    ├── Requests
    │   └── InvoiceRequest.php
    ├── Resources
    │   ├── InvoiceCollectionDataResource.php
    │   ├── InvoiceCollectionResource.php
    │   ├── InvoiceDataResource.php
    │   ├── InvoiceDraftResource.php
    │   ├── InvoiceIndexResource.php
    │   ├── InvoiceLabelResource.php
    │   ├── InvoiceLineDataResource.php
    │   ├── InvoiceLineResource.php
    │   ├── InvoiceMainOverviewResource.php
    │   ├── InvoiceResource.php
    │   └── InvoiceeResource.php
    └── ViewModels
        ├── InvoiceCollectionHabitantContractPreviewViewModel.php
        ├── InvoiceCollectionOwnerContractPreviewViewModel.php
        ├── InvoiceCollectionPreviewViewModel.php
        ├── InvoiceDraftViewModel.php
        ├── InvoiceIndexViewModel.php
        ├── InvoiceLabelsViewModel.php
        └── InvoiceStatusViewModel.php
```

感觉怎么样？当你在发票模块工作的时候，你有一个地方可以知道哪些代码是可用的。我倾向于把这些组称为『应用模块（application modules）』，或简称为『模块（modules）』。我可以用经验告诉你，当你在这种规模的项目中工作时，它们会让你变得更加轻松。这是否意味着模块应该在领域上进行一对一的映射？当然不是！注意，可能会有一些重叠，但这不是必须的。例如：我们在 `admin` 应用程序中有一个 `settings` 模块，它同时涉及到好几个领域。当我们在 `settings` 模块工作的时候，它是一个独立的功能，它的代码应该被放在一起，而不是分散在几个模块中，这正好和领域是同步的。

这个结构可能会出现的另一个问题是：我们应该如何处理通用类？像请求基类（base request class）、到处使用的中间件（middleware）等。还记得第一章中的 `Support` 命名空间吗？这就是它的作用！`Support` 命名空间容纳了所有会被全局访问的代码，这些代码也可以成为框架的一部分或独立的包。

现在你已经对如何构建应用程序有了一个总体的了解，以及为什么觉得它有用，是时候来看看我们使用的一些模式，以使我们的工作更轻松。

## 链接

- [目录](../README.md)
- 上一章：[领域测试（Testing domains）](0x08.md)
- 下一章: [视图模型（View models）](0x10.md)
